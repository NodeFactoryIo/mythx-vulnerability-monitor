import * as request from "request";

export const makePostRequest = (url, options) : Promise<any> => {
    return new Promise((resolve, reject) => {
        request.post(url, options, (error, res, body) => {
            if (error) {
                reject(error);
            }

            try {
                if (res.statusCode === 200) {
                    resolve(JSON.parse(body));
                } else {
                    reject(body);
                }
            } catch (error) {
                reject(error.message);
            }
        });
    });
};

export const makeGetRequest = (url, access = '') : Promise<any> => {
    const options = access ? {
        url,
        headers: {
            'Authorization': `Bearer ${access}`,
        },
    } : url;

    return new Promise((resolve, reject) => {
        request.get(options, (error, res, body) => {
            if (error) {
                reject(error);
            }

            try {
                if (res.statusCode === 200) {
                    resolve(JSON.parse(body));
                } else {
                    const error = new Error(body);
                    error['statusCode'] = res.statusCode;
                    reject(error);
                }
            } catch (error) {
                reject(error.message);
            }
        });
    });
};


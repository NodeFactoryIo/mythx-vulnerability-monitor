import * as request from "request";

export class MythX {
    public apiUrl: string;

    constructor() {
        this.apiUrl = process.env.MYTHX_API_URL || 'https://api.mythx.io/v1';
    }

    public refreshTokenRequest(access: string, refresh: string): Promise<{ access: string, refresh: string }> {
        const url = `${this.apiUrl}/auth/refresh`;
        const options = {
            form: {
                jwtTokens: {access, refresh},
            },
        };

        return new Promise((resolve, reject) => {
            request.post(url, options, (error, res, body) => {
                if (error) {
                    reject(error);
                }

                try {
                    resolve(JSON.parse(body));
                } catch (error) {
                    reject(error.message);
                }
            });
        });
    }
}

export default new MythX();

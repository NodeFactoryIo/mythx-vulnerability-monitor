import { fromJS } from 'immutable';
import { ANALYSES_FETCH_ERROR, ANALYSES_FETCH_REQUEST, ANALYSES_FETCH_SUCCESS } from './constants';
// The initial state of the App
const initialState = fromJS({
  loading: false,
  analyses: [],
});

function analysesReducer(state = initialState, action) {
  switch (action.type) {
    case ANALYSES_FETCH_REQUEST:
      return state
        .set('loading', true);
    case ANALYSES_FETCH_SUCCESS:
      const response = action.response.map(analysis => ({...analysis, report: JSON.parse(analysis.report) }));
      return state
        .set('loading', false)
        .set('analyses', response);
    case ANALYSES_FETCH_ERROR:
      return state
        .set('loading', false);
    default:
      return state;
  }
}

export default analysesReducer;
